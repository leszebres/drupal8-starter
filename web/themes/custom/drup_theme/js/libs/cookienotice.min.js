!function(l){"use strict";l.CookieNotice=function(e,s){return l.extend(!0,this.settings={},l.CookieNotice.defaults,s),this.elements={body:l("body"),container:e},this.elements.siteLinks=this.settings.siteLinks(this.elements.body),this.config=this.elements.container.attr("data-config"),this.cookieName="cookienotice",this.prepareOptions()?this.init():this},l.CookieNotice.defaults={siteLinks:function(e){return e.find('a[target!="_blank"]')},classes:{prefix:"cookienotice",notice:"notice notice--cookie",noticeOpen:"is-{prefix}-notice-open",modal:"modal modal--cookie",modalOpen:"is-{prefix}-modal-open",btnAgree:"{prefix}-agree",btnCustomize:"{prefix}-customize",active:"is-active"},reload:!0,summary:767,cookieDuration:390,afterWrapNotice:void 0,afterWrapModal:void 0,afterEventsHandler:void 0,onChangeState:void 0},l.CookieNotice.services={},l.CookieNotice.prototype={prepareOptions:function(){return!!navigator.cookieEnabled&&(this.replacePrefixClass(),this.elements.container.length?void 0===this.config||""===this.config?(this.setLog('Attribute "data-config" not found in the container element.',"error"),!1):(this.config=JSON.parse(this.config),!0):(this.setLog("Container element not found.","error"),!1))},init:function(){return this.wrapNotice(),this.loadStates()||(this.setState("all","undefined"),this.notice("show")),this.wrapModal(),this.eventsHandler(),this},destroy:function(){return this.elements.container.remove(),this.elements.body.removeClass(this.settings.classes.noticeOpen).removeClass(this.settings.classes.modalOpen),this},wrapNotice:function(){var e,s,t=[];return this.elements.noticeWrapper=l("<div>",{class:this.settings.classes.notice}),void 0!==this.config.notice.description&&""!==this.config.notice.description&&(this.elements.noticeDescription=l("<p>",{class:this.settings.classes.prefix+"-notice-description",html:this.config.notice.description}),this.elements.noticeDescription.appendTo(this.elements.noticeWrapper)),this.elements.noticeActionsWrapper=l("<div>",{class:this.settings.classes.prefix+"-notice-actions"}),void 0!==this.config.modal&&void 0!==this.config.notice.customize&&""!==this.config.notice.customize&&(s=l("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--secondary "+this.settings.classes.btnCustomize,html:l("<span>",{html:this.config.notice.customize})}).appendTo(this.elements.noticeActionsWrapper),e=this.elements.body.find("."+this.settings.classes.btnCustomize),t.push(s.get(0)),e.length&&t.push(e.get(0)),this.elements.btnCustomize=l(t)),void 0!==this.config.notice.agree&&""!==this.config.notice.agree&&(this.elements.btnAgree=l("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--primary "+this.settings.classes.btnAgree,html:l("<span>",{html:this.config.notice.agree})}).appendTo(this.elements.noticeActionsWrapper)),this.elements.noticeActionsWrapper.appendTo(this.elements.noticeWrapper),this.elements.noticeWrapper.appendTo(this.elements.container),void 0!==this.settings.afterWrapNotice&&this.settings.afterWrapNotice.call({cookieNotice:this,elements:this.elements}),this},notice:function(e){this.elements.body[("hide"===e?"remove":"add")+"Class"](this.settings.classes.noticeOpen)},wrapModal:function(){var o=this;if(void 0!==o.config.modal){if(o.elements.modalWrapper=l("<div>",{class:o.settings.classes.modal}),o.elements.modalHeader=l("<div>",{class:o.settings.classes.prefix+"-modal-header"}),void 0!==o.config.modal.label&&""!==o.config.modal.label&&l("<p>",{class:o.settings.classes.prefix+"-modal-label",html:o.config.modal.label}).appendTo(o.elements.modalHeader),void 0!==o.config.modal.description&&""!==o.config.modal.description&&l("<p>",{class:o.settings.classes.prefix+"-modal-description",html:o.config.modal.description}).appendTo(o.elements.modalHeader),void 0!==o.config.modal.close&&""!==o.config.modal.close&&(o.elements.modalClose=l("<button>",{class:o.settings.classes.prefix+"-modal-close",html:l("<span>",{html:o.config.modal.close})}).appendTo(o.elements.modalHeader)),o.elements.modalHeader.appendTo(o.elements.modalWrapper),void 0!==o.config.services){var t={};l.each(this.config.services,function(e,s){"all"!==e&&(void 0===t[s.group]&&(t[s.group]=[]),t[s.group].push(e))}),o.elements.servicesWrapper=l("<div>",{class:o.settings.classes.prefix+"-services"}),void 0!==o.config.services.all&&(o.elements.serviceAllWrapper=l("<div>",{class:o.settings.classes.prefix+"-service "+o.settings.classes.prefix+"-service--all","data-service":"all"}),l("<p>",{class:o.settings.classes.prefix+"-service-all-label",html:o.config.services.all.label}).appendTo(o.elements.serviceAllWrapper),o.wrapServiceActions("all").appendTo(o.elements.serviceAllWrapper),o.elements.serviceAllWrapper.appendTo(o.elements.servicesWrapper));var i=l("<ul>");l.each(t,function(e,s){var t=l("<li>",{class:o.settings.classes.prefix+"-group "+o.settings.classes.prefix+"-group--"+e}).appendTo(i);if(void 0!==o.config.groups[e].label&&""!==o.config.groups[e].label&&l("<p>",{class:o.settings.classes.prefix+"-group--label",html:o.config.groups[e].label}).appendTo(t),void 0!==o.config.groups[e].description&&""!==o.config.groups[e].description&&l("<p>",{class:o.settings.classes.prefix+"-group--description",html:o.config.groups[e].description}).appendTo(t),s.length){var n=l("<ul>");l.each(s,function(e,s){var t=l("<li>",{class:o.settings.classes.prefix+"-service "+o.settings.classes.prefix+"-service--"+s,"data-service":s}),i={class:o.settings.classes.prefix+"-service-label",html:o.config.services[s].label};(void 0!==o.config.services[s].url&&""!==o.config.services[s].url?(i.href=o.config.services[s].url,l("<a>",i)):l("<span>",i)).appendTo(t),o.wrapServiceActions(s).appendTo(t),t.appendTo(n)}),n.appendTo(t)}}),i.appendTo(o.elements.servicesWrapper),o.elements.servicesWrapper.appendTo(o.elements.modalWrapper)}o.elements.modalWrapper.appendTo(o.elements.container),o.elements.modalOverlay=l("<div>",{class:o.settings.classes.prefix+"-modal-overlay"}).appendTo(o.elements.container),void 0!==o.settings.afterWrapModal&&o.settings.afterWrapModal.call({cookieNotice:o,elements:o.elements})}return o},wrapServiceActions:function(n){var o=this,c=o.getState(n),a=l("<div>",{class:this.settings.classes.prefix+"-service-actions"});return l.each(["agree","disagree"],function(e,t){var s,i=0;void 0!==o.config.services.all[t]&&""!==o.config.services.all[t]&&(s="agree"===t&&!0===c||"disagree"===t&&!1===c?" "+o.settings.classes.active:"","all"===n&&(l.each(l.CookieNotice.services,function(e,s){"agree"===t&&!0===s?i++:"disagree"===t&&!1===s&&i++}),i===Object.keys(l.CookieNotice.services).length&&(s=" "+o.settings.classes.active)),l("<button>",{class:o.settings.classes.prefix+"-service-action "+o.settings.classes.prefix+"-service-action--"+t+s,"data-action":t,html:l("<span>",{html:o.config.services.all[t]})}).appendTo(a))}),a},modal:function(e){this.elements.body[("hide"===e?"remove":"add")+"Class"](this.settings.classes.modalOpen)},eventsHandler:function(){var e,n=this;return!1!==n.settings.summary&&n.elements.noticeDescription.length&&void 0!==n.config.notice.summary&&""!==n.config.notice.summary&&l(window).width()<=n.settings.summary&&(n.elements.noticeDescription.html(n.config.notice.summary),n.elements.noticeDescription.on("click",function(e){l(e.target).is("a")||n.elements.noticeDescription.html()===n.config.notice.description||n.elements.noticeDescription.html(n.config.notice.description)})),void 0!==n.elements.btnAgree&&n.elements.btnAgree.length&&n.elements.btnAgree.one("click.cookienotice.btnAgree",function(){n.agree(),n.notice("hide"),n.settings.reload?n.reload():n.elements.serviceAction.length&&n.elements.serviceAction.each(function(e,s){"agree"===(s=l(s)).attr("data-action")&&s.addClass(n.settings.classes.active)})}),void 0!==n.elements.btnCustomize&&n.elements.btnCustomize.length&&n.elements.btnCustomize.on("click.cookienotice.btnCustomize",function(e){e.preventDefault(),n.modal("show"),n.getCookie(n.cookieName)||n.notice("hide")}),void 0!==n.config.modal&&(e=function(e){("click"===e.type||"keydown"===e.type&&27===e.keyCode)&&(n.modal("hide"),n.getCookie(n.cookieName)||n.notice("show"),n.reload())},n.elements.modalClose.length&&n.elements.modalClose.on("click.cookienotice.modalClose",e),n.elements.modalOverlay.length&&n.elements.modalOverlay.on("click.cookienotice.modalOverlay",e),l(document).on("keydown.cookienotice.modalEscape",e),n.elements.serviceAction=n.elements.servicesWrapper.find("button."+n.settings.classes.prefix+"-service-action"),n.elements.serviceAction.on("click.cookienotice.serviceAction",function(e){var s=l(e.currentTarget),t=s.attr("data-action"),i=s.closest("."+n.settings.classes.prefix+"-service").attr("data-service");void 0!==t&&void 0!==i&&(s.siblings().removeClass(n.settings.classes.active),s.addClass(n.settings.classes.active),"all"===i?n.elements.serviceAction.filter('[data-action="'+t+'"]').each(function(e,s){(s=l(s)).siblings().removeClass(n.settings.classes.active),s.addClass(n.settings.classes.active)}):n.elements.serviceAllWrapper.find("button").removeClass(n.settings.classes.active),n.setState(i,"agree"===t))})),n.elements.siteLinks.not(n.elements.container.find("a")).not("."+n.settings.classes.btnCustomize).one("click.cookienotice.siteLinks",function(){n.agree(),n.notice("hide")}),void 0!==n.settings.afterEventsHandler&&n.settings.afterEventsHandler.call({cookieNotice:n,elements:n.elements}),n},agree:function(e){return e=e||"all",this.setState(e,!0)},disagree:function(e){return e=e||"all",this.setState(e,!1)},setState:function(e,s){return"all"===e&&void 0!==this.config.services?l.each(this.config.services,function(e){"all"!==e&&(l.CookieNotice.services[e]=s)}):l.CookieNotice.services[e]=s,"undefined"!==s&&(this.setCookie(this.cookieName,JSON.stringify(l.CookieNotice.services),this.settings.cookieDuration),void 0!==this.settings.onChangeState&&this.settings.onChangeState.call({cookieNotice:this,services:l.CookieNotice.services,service:e,state:s})),this},loadStates:function(){var e=this.getCookie(this.cookieName);return!!e&&(e=JSON.parse(e),l.each(e,function(e,s){l.CookieNotice.services[e]=s}),e)},getState:function(e){return void 0!==l.CookieNotice.services[e]?l.CookieNotice.services[e]:"undefined"},isAllowed:function(e){return!0===this.getState(e)},hasConsent:function(){return!!this.getCookie(this.cookieName)},reload:function(){this.settings.reload&&window.location.reload()},getCookie:function(e){return new RegExp("(?:; )?"+e+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null},setCookie:function(e,s,t,i){var n=new Date,o=new Date;i=i||"/",o.setTime(n.getTime()+24*t*60*60*1e3),document.cookie=e+"="+s+";expires="+o.toGMTString()+";path="+i+";"},removeCookie:function(e,s){return this.setCookie(e,"",-1,s)},setLog:function(e,s){s=s||"log",console[s]("CookieNotice: "+e)},replacePrefixClass:function(){var t=this;return l.each(t.settings.classes,function(e,s){"string"==typeof s&&(t.settings.classes[e]=s.replace(/{prefix}/,t.settings.classes.prefix))}),t}},l.fn.cookieNotice=function(e){return new l.CookieNotice(l(this),e)}}(jQuery);