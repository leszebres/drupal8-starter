!function(r){"use strict";r.Spinner=function(t,e){return this.elements={container:t},r.extend(!0,this.settings={},r.Spinner.defaults,e),this.timeout=null,this.prepareOptions()&&this.init(),this},r.Spinner.defaults={auto:!1,autoPathsExceptions:[],type:"overlay",wrapper:!0,spinner:!0,text:null,minTimeout:600,maxTimeout:8e3,classes:{prefix:"spinner",wrapper:"{prefix}-wrapper",wrapperInner:"{prefix}-wrapper-inner",text:"{prefix}-text",spinner:"l-spinner",loading:"is-loading"},beforeWrap:void 0,onShow:void 0,onHide:void 0},r.Spinner.prototype={prepareOptions:function(){var s=this;return r.each(s.settings.classes,function(t,e){"string"==typeof e&&(s.settings.classes[t]=e.replace(/{prefix}/,s.settings.classes.prefix))}),r.each(s.settings,function(t){var e=s.elements.container.attr("data-"+s.settings.classes.prefix+"-"+t);void 0!==e&&e.length&&(s.settings[t]="spinner"===t?!e:e)}),"button"===s.settings.type&&s.elements.container.is("input, img")&&(s.settings.wrapper=!1),!0},setOptions:function(t){return r.extend(!0,this.settings,t),this.refresh(),this},init:function(){return this.elements.container.hasClass(this.settings.classes.prefix)||(this.elements.container.addClass(this.settings.classes.prefix+" "+this.settings.classes.prefix+"--"+this.settings.type+" "+(this.settings.spinner?this.settings.classes.spinner:"")),this.elements.wrapper=r("<"+("button"===this.settings.type?"span":"div")+">",{class:this.settings.classes.wrapper}),this.settings.wrapper&&this.wrap(),this.settings.auto&&this.auto()),this},auto:function(){var i=this;return r(document).ajaxSend(function(t,e,s){var n=!0;i.settings.autoPathsExceptions.length&&r.each(i.settings.autoPathsExceptions,function(t,e){-1!==s.url.indexOf(e)&&(n=!1)}),n&&i.show()}).ajaxStop(function(){i.hide()}),i},destroy:function(){var n=this;return n.elements.container.removeClass(function(){var t=n.elements.container.attr("class").split(" "),s=null;if(t.length&&r.each(t,function(t,e){-1!==e.indexOf(n.settings.classes.prefix)&&(s+=" "+e)}),null!==s)return s.trim()}),0===n.elements.container.attr("class").length&&n.elements.container.removeAttr("class"),n.elements.wrapper.remove(),n},refresh:function(){return this.destroy().init()},wrap:function(){return this.elements.wrapper.empty(),this.elements.wrapperInner=r("<"+("button"===this.settings.type?"span":"div")+">",{class:this.settings.classes.wrapperInner}),null!==this.settings.text&&"button"!==this.settings.type&&(this.elements.text=r("<p>",{class:this.settings.classes.text,html:this.settings.text})),void 0!==this.settings.beforeWrap&&this.settings.beforeWrap.call({spinner:this,elements:this.elements}),this.elements.wrapper["overlay"===this.settings.type?"appendTo":"prependTo"](this.elements.container),this.elements.wrapperInner.appendTo(this.elements.wrapper),void 0!==this.elements.text&&this.elements.text.appendTo(this.elements.wrapperInner),this},show:function(t){return this.elements.container.addClass(this.settings.classes.loading),"button"===this.settings.type&&null!==this.settings.text&&(this.elements.wrapper.remove(),this.elements.buttontext=this.elements.container.html(),this.elements.container.text(this.settings.text),this.settings.wrapper&&this.wrap()),void 0!==this.settings.onShow&&this.settings.onShow.call({spinner:this,container:this.elements.container}),void 0!==t&&t.call({spinner:this,container:this.elements.container}),this.setTimeout(),this},hide:function(t){var e=this;return clearTimeout(e.timeout),setTimeout(function(){e.elements.container.removeClass(e.settings.classes.loading),"button"===e.settings.type&&null!==e.settings.text&&void 0!==e.elements.buttontext&&(e.elements.container.html(e.elements.buttontext),e.settings.wrapper&&e.wrap()),void 0!==e.settings.onHide&&e.settings.onHide.call({spinner:e,container:e.elements.container}),void 0!==t&&t.call({spinner:e,container:e.elements.container})},e.settings.minTimeout),this},setTimeout:function(){var t=this;void 0!==t.settings.maxTimeout&&0<t.settings.maxTimeout&&(t.timeout=setTimeout(function(){t.hide()},t.settings.maxTimeout))}},r.fn.spinner=function(t){return new r.Spinner(r(this),t)}}(jQuery);